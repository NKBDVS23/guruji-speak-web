<!-- charge.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Charge Page</title>
    
	<!-- Meta Pixel Code -->
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '879840060484568');
  fbq('track', 'PageView');
  </script>
  <noscript><img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=879840060484568&ev=PageView&noscript=1"
  /></noscript>
  <!-- End Meta Pixel Code -->
</head>
<body>
    <h1>Processing Payment</h1>
    <!-- You can add loading indicators or messages here -->
    <script src="{{ stripe_js_url }}"></script>
</body>
</html>
// Include Stripe.js library
<script src="https://js.stripe.com/v3/"></script>

<script>
// Assuming you have the 'stripe_js_url' available in your template
const stripeJsUrl = "{{ stripe_js_url }}";

// Initialize Stripe.js
const stripe = Stripe("your_stripe_publishable_key");

// Handle the 3D Secure authentication
stripe.handleCardAction(stripeJsUrl)
  .then(function(result) {
    if (result.error) {
      // Handle error
    } else {
      // Payment successful, continue to success page
      window.location.href = "{% url 'success_view' %}";
    }
  });
</script>
